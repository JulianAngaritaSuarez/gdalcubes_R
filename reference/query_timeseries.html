<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Query data cube timeseries at irregular spatial points — query_timeseries • gdalcubes</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Query data cube timeseries at irregular spatial points — query_timeseries" />
<meta property="og:description" content="This function will overlay provided spatial points with a data cube and return time series of all bands
of the cells for each query point, as a list of data.frame (one data frame per band) where rows correspond to points and columns represent time.
If needed, point coordinates are automatically transformed to the SRS of the data cube." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gdalcubes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/MODIS.html">1. Processing MODIS data with gdalcubes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/appelmar/gdalcubes_R/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Query data cube timeseries at irregular spatial points</h1>
    <small class="dont-index">Source: <a href='https://github.com/appelmar/gdalcubes_R/blob/master/R/query_timeseries.R'><code>R/query_timeseries.R</code></a></small>
    <div class="hidden name"><code>query_timeseries.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function will overlay provided spatial points with a data cube and return time series of all bands
of the cells for each query point, as a list of data.frame (one data frame per band) where rows correspond to points and columns represent time.
If needed, point coordinates are automatically transformed to the SRS of the data cube.</p>
    </div>

    <pre class="usage"><span class='fu'>query_timeseries</span>(<span class='no'>x</span>, <span class='no'>px</span>, <span class='no'>py</span>, <span class='no'>srs</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>source data cube</p></td>
    </tr>
    <tr>
      <th>px</th>
      <td><p>vector of x coordinates</p></td>
    </tr>
    <tr>
      <th>py</th>
      <td><p>vector of y coordinates</p></td>
    </tr>
    <tr>
      <th>srs</th>
      <td><p>spatial reference system string identifer (as GDAL understands)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of data.frames (one per band / variable) with one row per point and one column per data cube time slice</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># create image collection from example Landsat data only </span>
<span class='co'># if not already done in other examples</span>
<span class='kw'>if</span> (!<span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>(), <span class='st'>"L8.db"</span>))) {
  <span class='no'>L8_files</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"L8NY18"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"gdalcubes"</span>),
                         <span class='st'>".TIF"</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
  <span class='fu'><a href='create_image_collection.html'>create_image_collection</a></span>(<span class='no'>L8_files</span>, <span class='st'>"L8_L1TP"</span>, <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>(), <span class='st'>"L8.db"</span>))
}
<span class='no'>L8.col</span> <span class='kw'>=</span> <span class='fu'><a href='image_collection.html'>image_collection</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>(), <span class='st'>"L8.db"</span>))
<span class='no'>v</span> <span class='kw'>=</span> <span class='fu'><a href='cube_view.html'>cube_view</a></span>(<span class='kw'>extent</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>left</span><span class='kw'>=</span><span class='fl'>388941.2</span>, <span class='kw'>right</span><span class='kw'>=</span><span class='fl'>766552.4</span>,
              <span class='kw'>bottom</span><span class='kw'>=</span><span class='fl'>4345299</span>, <span class='kw'>top</span><span class='kw'>=</span><span class='fl'>4744931</span>, <span class='kw'>t0</span><span class='kw'>=</span><span class='st'>"2018-01-01"</span>, <span class='kw'>t1</span><span class='kw'>=</span><span class='st'>"2018-12-02"</span>),
              <span class='kw'>srs</span><span class='kw'>=</span><span class='st'>"EPSG:32618"</span>, <span class='kw'>nx</span> <span class='kw'>=</span> <span class='fl'>497</span>, <span class='kw'>ny</span><span class='kw'>=</span><span class='fl'>526</span>, <span class='kw'>dt</span><span class='kw'>=</span><span class='st'>"P14D"</span>)
<span class='no'>L8.cube</span> <span class='kw'>=</span> <span class='fu'><a href='raster_cube.html'>raster_cube</a></span>(<span class='no'>L8.col</span>, <span class='no'>v</span>)
<span class='no'>L8.rgb</span> <span class='kw'>=</span> <span class='fu'><a href='select_bands.html'>select_bands</a></span>(<span class='no'>L8.cube</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"B02"</span>, <span class='st'>"B03"</span>, <span class='st'>"B04"</span>))

<span class='no'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='kw'>from</span> <span class='kw'>=</span> <span class='fl'>388941.2</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='fl'>766552.4</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='fl'>10</span>)
<span class='no'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='kw'>from</span> <span class='kw'>=</span> <span class='fl'>4345299</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='fl'>4744931</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='fl'>10</span>)

<span class='fu'>query_timeseries</span>(<span class='no'>L8.rgb</span>, <span class='no'>x</span>, <span class='no'>y</span>, <span class='fu'><a href='srs.html'>srs</a></span>(<span class='no'>L8.rgb</span>))</div><div class='output co'>#&gt; $B02
#&gt;    2018-01-01 2018-01-15 2018-01-29 2018-02-12 2018-02-26 2018-03-12 2018-03-26
#&gt; 1         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 2         NaN        NaN        NaN        NaN       8678        NaN        NaN
#&gt; 3         NaN        NaN        NaN        NaN      12592        NaN        NaN
#&gt; 4         NaN        NaN        NaN        NaN      30430        NaN        NaN
#&gt; 5       11077        NaN        NaN        NaN      28223        NaN       9425
#&gt; 6       10125        NaN       7754        NaN        NaN        NaN       9851
#&gt; 7        8921        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 8         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt;    2018-04-09 2018-04-23 2018-05-07 2018-05-21 2018-06-04 2018-06-18 2018-07-02
#&gt; 1         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 2         NaN       9869        NaN        NaN       9835        NaN        NaN
#&gt; 3         NaN      10166        NaN        NaN       9797        NaN        NaN
#&gt; 4         NaN      23018        NaN        NaN       9340        NaN        NaN
#&gt; 5        9188      26634        NaN      32825      19620        NaN        NaN
#&gt; 6        9576       9296        NaN       9369        NaN        NaN       8875
#&gt; 7         NaN       9514        NaN        NaN        NaN        NaN        NaN
#&gt; 8         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt;    2018-07-16 2018-07-30 2018-08-13 2018-08-27 2018-09-10 2018-09-24 2018-10-08
#&gt; 1         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 2         NaN        NaN        NaN       9067        NaN        NaN        NaN
#&gt; 3         NaN        NaN        NaN       8879        NaN        NaN        NaN
#&gt; 4         NaN        NaN        NaN       8595        NaN        NaN        NaN
#&gt; 5         NaN        NaN        NaN       8665        NaN      10141        NaN
#&gt; 6         NaN        NaN        NaN      12651        NaN       7796        NaN
#&gt; 7         NaN        NaN        NaN       8232        NaN       7649        NaN
#&gt; 8         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt;    2018-10-22 2018-11-05 2018-11-19
#&gt; 1         NaN        NaN        NaN
#&gt; 2         NaN        NaN       7710
#&gt; 3         NaN        NaN       7426
#&gt; 4         NaN        NaN       7940
#&gt; 5        7546        NaN       8458
#&gt; 6        7620        NaN       8327
#&gt; 7         NaN        NaN        NaN
#&gt; 8         NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN
#&gt; 
#&gt; $B03
#&gt;    2018-01-01 2018-01-15 2018-01-29 2018-02-12 2018-02-26 2018-03-12 2018-03-26
#&gt; 1         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 2         NaN        NaN        NaN        NaN       7656        NaN        NaN
#&gt; 3         NaN        NaN        NaN        NaN      11964        NaN        NaN
#&gt; 4         NaN        NaN        NaN        NaN      29462        NaN        NaN
#&gt; 5       10487        NaN        NaN        NaN      27222        NaN       8061
#&gt; 6        9313        NaN       6910        NaN        NaN        NaN       9000
#&gt; 7        8101        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 8         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt;    2018-04-09 2018-04-23 2018-05-07 2018-05-21 2018-06-04 2018-06-18 2018-07-02
#&gt; 1         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 2         NaN       9159        NaN        NaN       9336        NaN        NaN
#&gt; 3         NaN       9595        NaN        NaN       9977        NaN        NaN
#&gt; 4         NaN      21931        NaN        NaN       9065        NaN        NaN
#&gt; 5        7959      25409        NaN      31770      18918        NaN        NaN
#&gt; 6        8873       8269        NaN       8774        NaN        NaN       8155
#&gt; 7         NaN       8789        NaN        NaN        NaN        NaN        NaN
#&gt; 8         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt;    2018-07-16 2018-07-30 2018-08-13 2018-08-27 2018-09-10 2018-09-24 2018-10-08
#&gt; 1         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 2         NaN        NaN        NaN       8092        NaN        NaN        NaN
#&gt; 3         NaN        NaN        NaN       8366        NaN        NaN        NaN
#&gt; 4         NaN        NaN        NaN       7767        NaN        NaN        NaN
#&gt; 5         NaN        NaN        NaN       7842        NaN       9627        NaN
#&gt; 6         NaN        NaN        NaN      11427        NaN       7174        NaN
#&gt; 7         NaN        NaN        NaN       7503        NaN       6981        NaN
#&gt; 8         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt;    2018-10-22 2018-11-05 2018-11-19
#&gt; 1         NaN        NaN        NaN
#&gt; 2         NaN        NaN       7082
#&gt; 3         NaN        NaN       6776
#&gt; 4         NaN        NaN       7526
#&gt; 5        6796        NaN       7652
#&gt; 6        7038        NaN       7516
#&gt; 7         NaN        NaN        NaN
#&gt; 8         NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN
#&gt; 
#&gt; $B04
#&gt;    2018-01-01 2018-01-15 2018-01-29 2018-02-12 2018-02-26 2018-03-12 2018-03-26
#&gt; 1         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 2         NaN        NaN        NaN        NaN       7689        NaN        NaN
#&gt; 3         NaN        NaN        NaN        NaN      12118        NaN        NaN
#&gt; 4         NaN        NaN        NaN        NaN      31194        NaN        NaN
#&gt; 5       10936        NaN        NaN        NaN      28889        NaN       7476
#&gt; 6        9672        NaN       6816        NaN        NaN        NaN       9433
#&gt; 7        7977        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 8         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt;    2018-04-09 2018-04-23 2018-05-07 2018-05-21 2018-06-04 2018-06-18 2018-07-02
#&gt; 1         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 2         NaN       8081        NaN        NaN       8395        NaN        NaN
#&gt; 3         NaN       8891        NaN        NaN       9908        NaN        NaN
#&gt; 4         NaN      23271        NaN        NaN       7610        NaN        NaN
#&gt; 5        7453      26758        NaN      32998      19156        NaN        NaN
#&gt; 6        9522       8054        NaN       7399        NaN        NaN       6851
#&gt; 7         NaN       9235        NaN        NaN        NaN        NaN        NaN
#&gt; 8         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt;    2018-07-16 2018-07-30 2018-08-13 2018-08-27 2018-09-10 2018-09-24 2018-10-08
#&gt; 1         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 2         NaN        NaN        NaN       6859        NaN        NaN        NaN
#&gt; 3         NaN        NaN        NaN       7032        NaN        NaN        NaN
#&gt; 4         NaN        NaN        NaN       6623        NaN        NaN        NaN
#&gt; 5         NaN        NaN        NaN       6979        NaN       9085        NaN
#&gt; 6         NaN        NaN        NaN      10503        NaN       6309        NaN
#&gt; 7         NaN        NaN        NaN       6541        NaN       6386        NaN
#&gt; 8         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN        NaN        NaN        NaN        NaN
#&gt;    2018-10-22 2018-11-05 2018-11-19
#&gt; 1         NaN        NaN        NaN
#&gt; 2         NaN        NaN       7041
#&gt; 3         NaN        NaN       6506
#&gt; 4         NaN        NaN       7765
#&gt; 5        6310        NaN       7709
#&gt; 6        6762        NaN       7356
#&gt; 7         NaN        NaN        NaN
#&gt; 8         NaN        NaN        NaN
#&gt; 9         NaN        NaN        NaN
#&gt; 10        NaN        NaN        NaN
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marius Appel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


