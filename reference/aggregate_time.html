<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Create a proxy data cube, which applies an aggregation function over pixel time series to lower temporal resolution."><title>Aggregate data cube time series to lower temporal resolution — aggregate_time • gdalcubes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate data cube time series to lower temporal resolution — aggregate_time"><meta property="og:description" content="Create a proxy data cube, which applies an aggregation function over pixel time series to lower temporal resolution."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gdalcubes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/gc01_MODIS.html">1. Creating data cubes from local MODIS imagery</a>
    <a class="dropdown-item" href="../articles/gc02_AWS_Sentinel2.html">2. Data cubes from Sentinel-2 data in the cloud</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/appelmar/gdalcubes_R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Aggregate data cube time series to lower temporal resolution</h1>
      <small class="dont-index">Source: <a href="https://github.com/appelmar/gdalcubes_R/blob/HEAD/R/aggregate_time.R" class="external-link"><code>R/aggregate_time.R</code></a></small>
      <div class="d-none name"><code>aggregate_time.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a proxy data cube, which applies an aggregation function over pixel time series to lower temporal resolution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">aggregate_time</span><span class="op">(</span><span class="va">cube</span>, <span class="va">dt</span>, method <span class="op">=</span> <span class="st">"mean"</span>, fact <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>cube</dt>
<dd><p>source data cube</p></dd>
<dt>dt</dt>
<dd><p>character; new temporal resolution, datetime period string, e.g. "P1M"</p></dd>
<dt>method</dt>
<dd><p>aggregation method, one of "mean", "min", "max", "median", "count", "sum", "prod", "var", and "sd"</p></dd>
<dt>fact</dt>
<dd><p>simple integer factor defining how many cells become aggregated to a single new cell, can be used instead of dt</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function can be used to aggregate time series to lower resolution or to regularize
a data cube with irregular (labeled) time axis. It is possible to change the unit of the temporal resolution (e.g. to create monthly composites from daily images).
The size of the cube may be expanded automatically if the original temporal extent is not divisible by the new temporal size of pixels.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function returns a proxy object, i.e., it will not start any computations besides deriving the shape of the result.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># create image collection from example Landsat data only </span></span>
<span class="r-in"><span class="co"># if not already done in other examples</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"L8.db"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="va">L8_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"L8NY18"</span>, package <span class="op">=</span> <span class="st">"gdalcubes"</span><span class="op">)</span>,</span>
<span class="r-in">                         <span class="st">".TIF"</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="create_image_collection.html">create_image_collection</a></span><span class="op">(</span><span class="va">L8_files</span>, <span class="st">"L8_L1TP"</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"L8.db"</span><span class="op">)</span><span class="op">)</span> </span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Image collection object, referencing 19 images with 12 bands</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Images:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       name      left      top   bottom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 LC08_L1TP_013032_20180131_20180207_01_T1 -74.67898 41.39099 39.25027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 LC08_L1TP_013032_20180405_20180417_01_T1 -74.70333 41.39106 39.25080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 LC08_L1TP_013032_20180421_20180502_01_T1 -74.70681 41.39107 39.25098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 LC08_L1TP_013032_20180710_20180717_01_T1 -74.66854 41.39096 39.24991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 LC08_L1TP_013032_20180827_20180911_01_T1 -74.67202 41.39097 39.25000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 LC08_L1TP_013032_20181030_20181115_01_T1 -74.69637 41.39104 39.25062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       right            datetime        srs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -71.92546 2018-01-31T00:00:00 EPSG:32618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -71.94695 2018-04-05T00:00:00 EPSG:32618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -71.95411 2018-04-21T00:00:00 EPSG:32618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -71.91114 2018-07-10T00:00:00 EPSG:32618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -71.91472 2018-08-27T00:00:00 EPSG:32618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -71.93979 2018-10-30T00:00:00 EPSG:32618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ omitted 13 images ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bands:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    name offset scale unit   nodata image_count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   B01      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   B02      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   B03      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   B04      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   B05      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   B06      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   B07      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   B08      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   B09      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  B10      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  B11      0     1      0.000000          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  BQA      0     1                        19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="va">L8.col</span> <span class="op">=</span> <span class="fu"><a href="image_collection.html">image_collection</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"L8.db"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="cube_view.html">cube_view</a></span><span class="op">(</span>extent<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>left<span class="op">=</span><span class="fl">388941.2</span>, right<span class="op">=</span><span class="fl">766552.4</span>, </span>
<span class="r-in">              bottom<span class="op">=</span><span class="fl">4345299</span>, top<span class="op">=</span><span class="fl">4744931</span>, t0<span class="op">=</span><span class="st">"2018-01"</span>, t1<span class="op">=</span><span class="st">"2018-12"</span><span class="op">)</span>,</span>
<span class="r-in">              srs<span class="op">=</span><span class="st">"EPSG:32618"</span>, nx <span class="op">=</span> <span class="fl">497</span>, ny<span class="op">=</span><span class="fl">526</span>, dt<span class="op">=</span><span class="st">"P3M"</span>, aggregation <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">L8.cube</span> <span class="op">=</span> <span class="fu"><a href="raster_cube.html">raster_cube</a></span><span class="op">(</span><span class="va">L8.col</span>, <span class="va">v</span>, mask<span class="op">=</span><span class="fu"><a href="image_mask.html">image_mask</a></span><span class="op">(</span><span class="st">"BQA"</span>, bits<span class="op">=</span><span class="fl">4</span>, values<span class="op">=</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">L8.rgb</span> <span class="op">=</span> <span class="fu"><a href="select_bands.html">select_bands</a></span><span class="op">(</span><span class="va">L8.cube</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B02"</span>, <span class="st">"B03"</span>, <span class="st">"B04"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">L8.two_monthly</span> <span class="op">=</span> <span class="fu">aggregate_time</span><span class="op">(</span><span class="va">L8.rgb</span>, <span class="st">"P6M"</span>, <span class="st">"min"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">L8.two_monthly</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A GDAL data cube proxy object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        low     high count       pixel_size chunk_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  2018-01  2018-12     2              P6M          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  4345299  4744931   526 759.756653992395        384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x 388941.2 766552.4   497 759.781086519115        384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bands:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   name offset scale nodata unit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  B02      0     1    NaN     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  B03      0     1    NaN     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  B04      0     1    NaN     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">L8.two_monthly</span>, rgb<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5000</span>,<span class="fl">12000</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="aggregate_time-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marius Appel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

